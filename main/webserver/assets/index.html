<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AS608 Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <h1>AS608 <span>Dashboard</span></h1>
            <div class="connection-status">
                <span id="ws-status" class="status-dot disconnected"></span>
                <span id="ws-text">Disconnected</span>
            </div>
        </div>
    </header>

    <!-- Event Badge - Real-time Status Display -->
    <div class="event-banner" id="event-banner">
        <span class="event-text" id="event-text">Sẵn sàng</span>
    </div>

    <!-- Main Container -->
    <main class="container">
        <!-- Status Card -->
        <section class="card">
            <h2>Trạng thái</h2>
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-label">Cảm biến</span>
                    <span class="status-value" id="sensor-status">--</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Đã đăng ký</span>
                    <span class="status-value" id="finger-count">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Tối đa</span>
                    <span class="status-value" id="library-size">162</span>
                </div>
                <div class="status-item">
                    <span class="status-label">ID tiếp</span>
                    <span class="status-value" id="next-id">0</span>
                </div>
            </div>
            <div class="state-display">
                <span class="state-label">Chế độ:</span>
                <span class="state-badge" id="state-badge">CHỜ</span>
            </div>
        </section>

        <!-- Actions Card -->
        <section class="card">
            <h2>Thao tác</h2>
            <div class="action-grid">
                <button class="btn btn-primary" id="btn-enroll">
                    Thêm vân tay
                </button>
                <button class="btn btn-secondary" id="btn-match">
                    Kiểm tra
                </button>
            </div>
            <div class="action-grid">
                <button class="btn btn-warning" id="btn-delete">
                    Xóa vân tay
                </button>
                <button class="btn btn-danger" id="btn-clear">
                    Xóa tất cả
                </button>
            </div>
            <button class="btn btn-cancel" id="btn-cancel" disabled>
                Hủy
            </button>
        </section>

        <!-- Volume Control -->
        <section class="card">
            <h2>Âm lượng</h2>
            <div class="volume-control">
                <input type="range" id="volume-slider" min="0" max="100" value="50">
                <span class="volume-value" id="volume-value">50%</span>
            </div>
        </section>

        <!-- OTA Update -->
        <section class="card">
            <h2>Cập nhật firmware</h2>
            <div class="ota-info">
                <div class="status-item">
                    <span class="status-label">Phiên bản</span>
                    <span class="status-value" id="ota-version">--</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Trạng thái</span>
                    <span class="status-value" id="ota-state">--</span>
                </div>
            </div>
            <div class="ota-upload">
                <input type="file" id="ota-file" accept=".bin" hidden>
                <button class="btn btn-secondary" id="btn-ota-select">
                    Chọn file .bin
                </button>
                <span class="file-name" id="ota-filename">Chưa chọn file</span>
            </div>
            <button class="btn btn-primary" id="btn-ota-upload" disabled>
                Cập nhật firmware
            </button>
            <div class="ota-progress" id="ota-progress-container" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="ota-progress-bar"></div>
                </div>
                <span class="progress-text" id="ota-progress-text">0%</span>
            </div>
        </section>

        <!-- Fingerprint List -->
        <section class="card">
            <div class="card-header">
                <h2>Danh sách vân tay</h2>
                <button class="btn btn-small" id="btn-refresh">Làm mới</button>
            </div>
            <ul class="finger-list" id="finger-list">
                <li class="empty-state">Chưa có vân tay nào</li>
            </ul>
        </section>
    </main>

    <!-- Delete ID Modal -->
    <div class="modal" id="delete-modal">
        <div class="modal-content">
            <h3>Xóa vân tay</h3>
            <p>Nhập ID cần xóa:</p>
            <input type="number" id="delete-id-input" min="0" max="161" placeholder="ID (0-161)">
            <div class="modal-actions">
                <button class="btn btn-secondary" id="delete-modal-cancel">Hủy</button>
                <button class="btn btn-danger" id="delete-modal-confirm">Xóa</button>
            </div>
        </div>
    </div>

    <!-- Rename Modal -->
    <div class="modal" id="rename-modal">
        <div class="modal-content">
            <h3>Đặt tên vân tay</h3>
            <p>ID: <span id="rename-id-display">0</span></p>
            <input type="text" id="rename-input" maxlength="31" placeholder="Nhập tên (VD: Nguyen Van A)">
            <div class="modal-actions">
                <button class="btn btn-secondary" id="rename-modal-cancel">Bỏ qua</button>
                <button class="btn btn-primary" id="rename-modal-confirm">Lưu</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="modal" id="confirm-modal">
        <div class="modal-content">
            <h3 id="confirm-title">Xác nhận</h3>
            <p id="confirm-message">Bạn có chắc chắn?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="confirm-cancel">Hủy</button>
                <button class="btn btn-danger" id="confirm-ok">Xác nhận</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-message" id="toast-message"></span>
    </div>

    <!-- Scripts -->
    <script src="ws.js"></script>
    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>
